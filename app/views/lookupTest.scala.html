@()(implicit request: RequestHeader)
@import play.api.Play.{current, configuration};

@main("ARCLITE Dictionary Lookup Service") {
    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/main.css">

    <div class="container">
       <div style="width: 40%; height: 550px; float:left; ">
            <div style="margin: 5px; background-color: #fff; height: 325px; text-align: left; padding: 10px;">
                <h1>Look Up Test</h1>
                <form action="javascript:checkIfEmpty();">
                    <label>Word or Phrase to be Translated: <input type="text" id="words_to_translate"/></label>
                    <br><br> Translator
                    <label> Source Language:
                        <select id = "nativelanguageselection">
                            <option value = "eng">English</option>
                            <option value = "sqi">Albanian</option>
                            <option value = "arz">Arabic Egyptian</option>
                            <option value = "apc">Arabic Syrian</option>
                            <option value = "ara">Arabic</option>
                            <option value = "hye">Armenian</option>
                            <option value = "bel">Belarusian</option>
                            <option value = "ben">Bengali</option>
                            <option value = "cat">Catalan</option>
                            <option value = "zho">Chinese</option>
                            <option value = "ces">Czech</option>
                            <option value = "nld">Dutch</option>
                            <option value = "fra">French</option>
                            <option value = "deu">German</option>
                            <option value = "heb">Hebrew</option>
                            <option value = "hin">Hindi</option>
                            <option value = "ita">Italian</option>
                            <option value = "jpn">Japanese</option>
                            <option value = "jav">Javanese</option>
                            <option value = "kor">Korean</option>
                            <option value = "lav">Latvian</option>
                            <option value = "pol">Polish</option>
                            <option value = "por">Portuguese</option>
                            <option value = "ron">Romanian</option>
                            <option value = "rus">Russian</option>
                            <option value = "smo">Samoan</option>
                            <option value = "spa">Spanish</option>
                            <option value = "tel">Telugu</option>
                            <option value = "tur">Turkish</option>
                            <option value = "ukr">Ukrainian</option>
                            <option value = "vie">Vietnamese</option>
                    </select>
                    </label>
                    <br>
                    <label> Target Language:
                        <select id = "secondlanguageselection">
                            <option value = "eng">English</option>
                            <option value = "sqi">Albanian</option>
                            <option value = "arz">Arabic Egyptian</option>
                            <option value = "apc">Arabic Syrian</option>
                            <option value = "ara">Arabic</option>
                            <option value = "hye">Armenian</option>
                            <option value = "bel">Belarusian</option>
                            <option value = "ben">Bengali</option>
                            <option value = "cat">Catalan</option>
                            <option value = "zho">Chinese</option>
                            <option value = "ces">Czech</option>
                            <option value = "nld">Dutch</option>
                            <option value = "fra">French</option>
                            <option value = "deu">German</option>
                            <option value = "heb">Hebrew</option>
                            <option value = "hin">Hindi</option>
                            <option value = "ita">Italian</option>
                            <option value = "jpn">Japanese</option>
                            <option value = "jav">Javanese</option>
                            <option value = "kor">Korean</option>
                            <option value = "lav">Latvian</option>
                            <option value = "pol">Polish</option>
                            <option value = "por">Portuguese</option>
                            <option value = "ron">Romanian</option>
                            <option value = "rus">Russian</option>
                            <option value = "smo">Samoan</option>
                            <option value = "spa">Spanish</option>
                            <option value = "tel">Telugu</option>
                            <option value = "tur">Turkish</option>
                            <option value = "ukr">Ukrainian</option>
                            <option value = "vie">Vietnamese</option>
                    </select>
                    </label>
                    <br><br>
                    <label>Security Key <br> <input type="password" id ="security_key" /></label>
                    <br>
                    <input type="submit" id="submitButton" />
                </form>
            </div>
        </div>
        <div style="width: 60%; float:left;">
            <div style="margin: 5px; background-color: #fff; min-height: 325px; text-align: left; padding: 10px;">
                <h1>Lookup Results</h1>
                <!-- <p id ='partOfSpeech'> </p> -->
                <!-- <p1 id ='wordSearched'></p1>  -->
                <br>
                <p id="Def"></p> 
                <p id="final_translation"></p>
                <br>
                <div id="attribution";  style = "background-color: #FFF; height: 50px; align:left; vertical-align:center;"></div>
            </div>
        </div>

        <div class="footer">
            Contact us at <a href="mailto:arclitelab@@gmail.com">arclitelab@@gmail.com</a>
        <div>
    </div>

    <script type ="text/javascript">

        function checkIfEmpty(){
            var word = document.getElementById("words_to_translate").value;
            if(word === ""){
                alert("You have nothing in the submit box\nPlease input something to translate.");
            }else if(word !== ""){
                Lookup();
            }
        }

        function Lookup(){
            var xhr = new XMLHttpRequest(),
                security_key_to_check = document.getElementById("security_key").value,
                srclang = document.getElementById("nativelanguageselection").value,
                dstlang = document.getElementById("secondlanguageselection").value,
                lookupWord = document.getElementById("words_to_translate").value;

            xhr.addEventListener('load',function(){
                var resp;
                if(xhr.status == 401){
                    alert("Error, you have incorrect key");
                    console.log(xhr.responseText);
                    return;
                }
                else if (xhr.status == 404) {
                    alert("Error, Requested from a resource that does not exist");
                    console.log(xhr.responseText);
                    return;
                }
                resp = JSON.parse(xhr.responseText);
                if(resp.entries === void 0){  // Make sure we actually received translations
                    alert("No data recieved");
                }else{
                    displayResult({
                        text: lookupWord,
                        translations: resp.entries,
                        engine: resp.source,
                        srcLang: srclang,
                        destLang: dstlang
                    });
                }
            },false);

            xhr.addEventListener("error",function(e){
                alert("An Error Occurred in Lookup");
                console.dir(e);
            },false );

            xhr.open("POST", "@{routes.Lookup.authlookup().absoluteURL(configuration.getBoolean("HTTPS").getOrElse(false))}",true);
            xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhr.setRequestHeader("Authorization", security_key_to_check);
            xhr.send("srcLang="+encodeURIComponent(srclang)+
                     "&destLang="+encodeURIComponent(dstlang)+
                     "&word="+encodeURIComponent(lookupWord));
        }

        function displayResult(data){
            var theWebsite;
            document.getElementById('Def').innerHTML = "Definition for: "
                + data.text.toUpperCase();
            switch(data.engine){
                case "Merriam-Webster Inc.":
                    document.getElementById('final_translation').innerHTML =
                    data.translations.map(function(entry, i){
                        return entry
                    }).join('<br/>');

                    var  logoURL = "http://www.dictionaryapi.com/images/info/branding-guidelines/mw-logo-light-background-50x50.png";
                    if((data.srcLang==="eng") || (data.destLang==="eng")){
                        theWebsite = '<img src="' + "http://www.dictionaryapi.com/images/info/branding-guidelines/mw-logo-light-background-50x50.png" + 
                        '" style="float:left; margin-right:25px"> </img> <p style="vertical-align: middle; height:50px;"><a href=http://www.merriam-webster.com/dictionary/' +
                        data.text + ' target = _blank> Results Provided by <br> Merriam-Webster Inc. </a> </p>';
                    } 
                    else if((data.srcLang==="spa") || (data.destLang==="spa")){
                        theWebsite = '<img src="' + "http://www.dictionaryapi.com/images/info/branding-guidelines/mw-logo-light-background-50x50.png" +
                        '" style="float:left; margin-right:25px"> </img> <p style="vertical-align: middle; height:50px;">Results Provided by Merriam-Webster Inc.<br><a href=http://www.spanishcentral.com/translate/'+
                        data.text + ' target = _blank> Results Provided by <br> Merriam-Webster Inc. </a> </p>';
                    }
                    break;
                case "WordReference":
                        document.getElementById('final_translation').innerHTML =
                    data.translations.map(function(entry, i){
                        return entry.replace("", i+1 + ": ");
                         }).join('<br/>');
                    theWebsite = 'Results Provided WordReference <a target =_blank href=http://www.wordreference.com/'
                    +[data.srcLang] + '/' + [data.destLang] + '/translation.asp?spen='
                        + data.text + '> Link to dictionary entry for "'
                        + data.text + '" </a>';
                    break;

                case "Glosbe":
                    document.getElementById('final_translation').innerHTML =
                    data.translations.map(function(entry, i){
                        return entry.replace("", i+1 + ": ");
                         }).join('<br/>');

                    theWebsite = '<img src=' + "'@routes.Assets.at( file = "images/GlosbeLogo.png")'" +
                    '" style="float:left; margin-right:25px height= "50px" width= "50px"> </img> <p style="vertical-align: middle; height:50px;"><br><a href=https://en.glosbe.com/' + data.srcLang + '/' + data.destLang + '/' + data.text
                    + ' target = _blank>  Results Provided by<br> Glosbe. </a> </p>';
                    break;
                default:
                    document.getElementById('final_translation').innerHTML =
                    data.translations.map(function(entry, i){
                        return entry.replace("", i+1 + ": ");
                    }).join('<br/>');
                    theWebsite = "Results Provided by " + data.engine;
            }
            document.getElementById('attribution').innerHTML = theWebsite;
        }
    </script>
}